<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta property="og:title" content="CodePush" />
  <meta property="og:site_name" content="CodePush"/>
  <meta property="og:description" content="While the CodePush CLI provides a simple experience for managing your account, it could become pretty tedious doing manual deployments every time you need to..." />
  <meta property="og:image" content="https://microsoft.github.io/code-push/assets/images/fbshare.PNG" />
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@Microsoft">
  <meta name="twitter:title" content="CodePush">
  <meta name="twitter:description" content="While the CodePush CLI provides a simple experience for managing your account, it could become pretty tedious doing manual deployments every time you need to...">
  <meta name="twitter:image" content="https://microsoft.github.io/code-push/assets/images/fbshare.PNG">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
  <meta name="description" content="While the CodePush CLI provides a simple experience for managing your account, it could become pretty tedious doing manual deployments every time you need to...">

  <title>
    
      Continuous Delivery with CodePush and VSTS &middot; CodePush
    
  </title>
  
  <!-- build:css  /assets/css/vendor.css -->
  <link rel="stylesheet" href="/code-push/libraries/bootstrap/dist/css/bootstrap.css" />
  <link rel="stylesheet" href="/code-push/libraries/highlightjs/styles/solarized_light.css">
  <link rel="stylesheet" href="/code-push/libraries/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/code-push/libraries/github-fork-ribbon-css/gh-fork-ribbon.css">
  <!-- endbuild -->
  
  <!-- CSS -->
  <!-- build:css /assets/css/style.min.css -->
  <link rel="stylesheet" href="/code-push/assets/stylesheets/style.css">
  <link rel="stylesheet" href="/code-push/assets/stylesheets/ga.style.css">
  <!-- endbuild -->             

  <!-- Icons --> <!-- TODO: Check that these all wok -->
  <link rel="apple-touch-icon" sizes="57x57" href="/code-push/assets/images/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/code-push/assets/images/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/code-push/assets/images/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/code-push/assets/images/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/code-push/assets/images/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/code-push/assets/images/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/code-push/assets/images/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/code-push/assets/images/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/code-push/assets/images/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/code-push/assets/images/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/code-push/assets/images/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/code-push/assets/images/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/code-push/assets/images/icons/favicon-16x16.png">
  <link rel="manifest" href="/code-push/assets/images/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#294E80">
  <meta name="msapplication-TileImage" content="/code-push/assets/images/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <!-- JS -->    
  <!-- Redirect logic from this docs(as it was depricated) to new docs https://docs.microsoft.com/en-us/appcenter/distribution/codepush/   -->    
  <script src="/code-push/assets/javascript/redirect.js"></script>

	<!-- build:js  /assets/js/vendors.js  -->	
	<script src="/code-push/libraries/jquery/dist/jquery.min.js"></script>
	<script src="/code-push/libraries/bootstrap/dist/js/bootstrap.js"></script>
  <script src="/code-push/libraries/zeroclipboard/dist/ZeroClipboard.min.js"></script>
  <script src="/code-push/libraries/anchorific.js/min/anchorific.min.js"></script>
  <script src="/code-push/libraries/toc/dist/toc.min.js"></script>
  <script src="/code-push/libraries/highlightjs/highlight.pack.min.js"></script>
  <!-- endbuild -->   
  
  <!-- build:js /assets/js/all.min.js -->
  <script src="/code-push/assets/javascript/global.js"></script>
  <script src="/code-push/assets/javascript/home.js"></script>  
  <script src="/code-push/assets/javascript/docs.js"></script>
  <script src="/code-push/assets/javascript/faq.js"></script>
  <!-- endbuild -->
 
  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/code-push/atom.xml">

    
</head>
<body>
    <header role="banner">
	<nav class="navbar navbar-default navbar-fixed-top">
		 <div class="container-fluid">
        	<!--<img class="fork-me-ribbon pull-right" src="../assets/images/fork_me_ribbon.svg" />-->
		    <!-- Brand and toggle get grouped for better mobile display -->
		    <div class="navbar-header">
		      <button type="button" class="navbar-toggle pull-left collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
		        <span class="sr-only">Toggle navigation</span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		      </button>
		      <a class="navbar-brand" href="/code-push/index.html">
						<img class="navbar-logo" src="/code-push/assets/images/codepush_navbar_logo.svg">
							<sup class="navbar-logo-text">PREVIEW</sup>
						</image>
					</a>
		    </div>
		    <!-- Collect the nav links, forms, and other content for toggling -->
		    <div class="collapse navbar-collapse navbar_center" id="bs-example-navbar-collapse-1">
		      <ul class="nav navbar-nav">
				<li class=""><a href="/code-push/index.html#getting_started">Getting Started</a></li>
				<li class=""><a href="/code-push/docs/index.html">Documentation</a></li>
		        <li class=""><a href="/code-push/faq/index.html">FAQ</a></li>
				<li class=""><a href="/code-push/blog/index.html">Blog</a></li>
                <li class=""><a href="/code-push/community/friends.html">Showcase</a></li>
		      </ul>
		    </div><!-- /.navbar-collapse -->
		</div><!-- /.container-fluid -->
	</nav>				   		
</header>
<div class="top_navbar_spacer"></div>
	<div class="post">
    <div id="content" class="container main_content">   
        <div class="row">
            <div class="col-md-10 col-md-offset-1"> 
                <div class="post-header">
                    <h1>Continuous Delivery with CodePush and VSTS</h1>
                    <span class="date">18 Nov 2015</span><span>&nbsp;- by</span><span class="author"><a href="https://twitter.com/lostintangent">Jonathan Carter</a></span>
                </div>
                <p>While the <a href="http://microsoft.github.io/code-push/docs/cli.html">CodePush CLI</a> provides a simple experience for managing your account, it could become pretty tedious doing manual deployments every time you need to release an update, particularly if you want to keep your dev/staging/etc. deployments always current. To better enable scripting a custom continuous delivery solution from your CI environment (e.g. Travis), we enhanced the CLI in the <a href="http://microsoft.github.io/code-push/articles/CodePush1.1.html">1.1 release</a> with the ability to create access keys and authenticate with them &ldquo;headlessly&rdquo;, but we wanted to make it even simpler to automated this process E2E.</p>

<p>To take advantage of the new <a href="https://marketplace.visualstudio.com/#VSTS">marketplace</a> for Visual Studio Team Services (formally &ldquo;Visual Studio Online&rdquo;), we created a <a href="http://marketplace.visualstudio.com/items/ms-vsclient.code-push">CodePush extension</a> which makes adding a deployment step to your CI build pipeline pretty easy, and composes really well with the <a href="http://marketplace.visualstudio.com/items/ms-vsclient.cordova-extension">Cordova Build</a> extension and existing <a href="https://github.com/Microsoft/vso-agent-tasks">core support</a> for JavaScript apps (e.g. Running Gulp scripts, installing NPM dependencies). If you&rsquo;re already using VSTS/VSO, then install the extension now and give it a shot! Otherwise, we encourage you to check it out if you&rsquo;re in the market for a simple and great CI/ALM solution.</p>

<h2>Deploy Task</h2>

<p>The CodePush task itself is pretty simple, and if you&rsquo;re already familiar with the CLI, it provides all of the same input options as the <code>release</code> command. Addtitionally, in order to make it simple to authenticate with the service from CI, it provides an <code>Access Key</code> input that accepts a key value which you can generate using the existing <code>code-push access-key add</code> command <em>(NOTE: Give your key a recognizeable name)</em>. The task will automatically handle logging-in, performing the release, and then logging-out so that your session information isn&rsquo;t left around on the machine.</p>

<p>That&rsquo;s it! Nothing too magical, but hopefully it makes the barrier of entry even simpler to perform these kind of automated deployments. For more info about the task inputs and/or how to get started with it, refer to the <a href="https://github.com/Microsoft/code-push-vsts-extension#quick-start">GitHub repo</a>.</p>

<p><img src="https://cloud.githubusercontent.com/assets/116461/11203765/1aca758a-8cac-11e5-8f27-02efaafccbe5.png" alt="Example"></p>

<h2>Cordova</h2>

<p>While most of the task&rsquo;s options are platform agnostic, in order to specify a valid value for the <code>Package Path</code> field, you need to be able to easily build your app&rsquo;s release assets from a CI environment. For Cordova, that means running either <code>cordova build &lt;platformName&gt;</code> or <code>cordova prepare &lt;platformName&gt;</code> (either is sufficient for a CodePush, but we recommend the later since it&rsquo;s simpler), or the equivalent using a superset CLI (e.g. Ionic, PhoneGap, Tarifa, TACO).</p>

<p>While you could script this yourself, the <a href="http://marketplace.visualstudio.com/items/ms-vsclient.cordova-extension">Cordova Build</a> extension makes this easy to do, since it provides tasks for running either a build (using the <a href="http://msdn.microsoft.com/Library/vs/alm/Build/cordova/cordova-build">Cordova Build</a> task) or a prepare (using the <a href="http://msdn.microsoft.com/Library/vs/alm/Build/cordova/cordova-command">Cordova Command</a> task or <a href="http://msdn.microsoft.com/Library/vs/alm/Build/cordova/ionic-command">Ionic Command</a>, with the <code>Command</code> input set to <code>prepare &lt;platformName&gt;</code>).</p>

<p>Using these tasks, along with the CodePush deploy task, you can easily configure a build + deploy workflow. Additionally, if your app needs to acquire NPM/Bower dependencies and/or run any Gulp scripts, there are built-in tasks in VSTS for that (no extension needed!). For more info on the Cordova Build extension, including how to get started with it, refer to the <a href="https://github.com/Microsoft/vso-cordova-tasks#5-step-quick-start">GitHub repo</a>.</p>

<p><img src="https://cloud.githubusercontent.com/assets/116461/11220739/3779322e-8d16-11e5-8443-1a3db51a88b6.png" alt="Ionic Command Task"></p>

<p><em>NOTE: There are plans to introduce additional tasks for other Cordova-based CLIs such as PhoneGap and TACO, so stay tuned for updates on that front.</em></p>

<h2>React Native</h2>

<p>Generating your release assets for a React Native app consists of calling the <code>react-native bundle</code> CLI command, which produces the JS bundle you can subsequently pass to the <code>Package Path</code> field of the CodePush task. The React Native CLI requires Node 4+, which isn&rsquo;t installed by default on the VSTS hosted build machines, so your build script needs to &ldquo;prime&rdquo; the environment first, before being able to create the bundle (*).</p>

<p>Currently, there isn&rsquo;t a React Native extension for VSTS that handles the Node/React Native CLI acquisition for you (yet!), however, there are core VSTS tasks for running shell scripts, which enables you to achieve just about anything when needed. To that end, we created some <a href="https://github.com/Microsoft/code-push-vsts-extension/tree/master/vsts-scripts">setup scripts</a> (use the Windows or OS X ones depending on your environment), that you can add to your repo for now, and run as part of your build setup.</p>

<p>With these scripts in hand, your CI pipeline can be composed of the following three tasks/steps:</p>

<ol>
<li><p><strong>Shell script</strong> or <strong>Batch Script</strong> (depending on if you&rsquo;re using a Windows or OSX build machine)&ndash;that points at either the <code>setup-react-native.sh</code> or <code>setup-react-native.bat</code> file respectively&ndash;which handles installing the right Node version as well as the React Native CLI globally</p></li>
<li><p><strong>Command Line</strong> task, which can be used to run the <code>react-native bundle</code> command, passing the neccessary parameters for your app (e.g. platform, entry file name)</p></li>
<li><p><strong>CodePush</strong> deploy task, which points at the JS bundle created in #2</p></li>
</ol>

<p><img src="https://cloud.githubusercontent.com/assets/116461/11228630/da50e2fe-8d42-11e5-812b-713faa56d9bc.png" alt="React CI"></p>

<p>Beyond automating your CodePush deployments, if you want to setup an automated build for generating your  ipa and/or apk files, you can use the <strong>Xcode Build</strong> and <strong>Gradle</strong> tasks that are already built into VSTS. </p>

<p>Additionally, while VSTS provides Windows-based build machines, <a href="http://connect.macincloud.com">MacinCloud</a> released first-class support today for running your VSTS builds on OSX machines, so that is definitely worth checking out once you need to run your automated iOS builds.</p>

<p><em>(NOTE: Besides using the cloud-hosted build machines, VSTS also lets you setup and run your own build machine using their cross-platform <a href="https://github.com/Microsoft/vso-agent">build agent</a>, which lets you install any additional dependecies your builds may require)</em></p>

<h2>Send us feedback</h2>

<p>We&rsquo;re pretty excited about this experience, and there&rsquo;s lot of cool stuff happening for &ldquo;mobile DevOps&rdquo;, but we definitely want to continue making it simpler (including first-class support for React Native), so stay tuned!</p>

<p>In the meantime, if you have any feedback/comments/etc. please don&rsquo;t hesitate to <a href="mailto:codepushfeed@microsoft.com">ping us</a>. We need your help with ensuring we fully accomodate the CI/CD workflow for CodePush for any unique scenarios you may have. Thanks!</p>

            </div>
        </div>
    </div>
</div>
	<footer>
    <div class="footer-container">
        <div class="container" id="footer">
            <div class="row">
                <div class="col-sm-9">
                    <div class="row">
                        <div class="col-sm-4">
                            <h4>General</h4>
                            <ul class="nav">
                                <!--TODO: CHECK LINKS-->
                                <li><a href="https://github.com/Microsoft/code-push/blob/master/LICENSE.md" target="_blank">License</a></li>
                                <li><a href="https://www.visualstudio.com/en-us/privacy-policy-vs" target="_blank">Privacy</a></li>
                                <li><a href="https://msdn.microsoft.com/en-us/cc300389" target="_blank">Terms of Service</a></li>
                            </ul>
                        </div>
                        <div class="col-sm-4">
                            <h4>Community</h4>
                            <ul class="nav">
                                <li><a href="https://github.com/Microsoft/code-push/" target="_blank">GitHub Project</a></li>
                                <li><a href="https://stackoverflow.com/questions/tagged/codepush" target="_blank">Stack Overflow</a></li>
                                <li><a href="https://twitter.com/hashtag/codepush" target="_blank">#CodePush</a></li>
                            </ul>
                        </div>
                        <div class="col-sm-4">
                            <h4>Documentation</h4>
                            <ul class="nav">
                                <li><a href="https://github.com/Microsoft/code-push/blob/master/cli/README.md" target="_blank">CLI Docs</a></li>
                                <li><a href="https://github.com/Microsoft/cordova-plugin-code-push/blob/master/README.md" target="_blank">Cordova Plugin Docs</a></li>
                                <li><a href="https://github.com/Microsoft/react-native-code-push/blob/master/README.md" target="_blank">React Native Plugin Docs</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <h3><i class="fa fa-comment"></i> Talk to us!</h3>
                    <p>If you have any feedback or suggestions on how we can make CodePush more awesome, please contact via Twitter <a href="https://twitter.com/mscodepush">@mscodepush, <a href=mailto:codepush@microsoft.com>email us</a> or ping us in the <a href="https://discord.gg/0ZcbPKXt5bWxFdFu">#code-push</a> channel on Reactiflux (for React Native).</p>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid signature-container">
        <div class="container">
            <div class="row signature">          
                <p class="pull-left hidden-xs">Made with <span class="glyphicon glyphicon-heart"></span> in Redmond</p> 
                <div class="pull-right">
                    <p class="copyright pull-left">&copy;2012-2017 Microsoft
                    <img class="ms-logo-footer" src="/code-push/assets/images/Microsoft_logo.svg"/></p>
                </div>              
            </div>
        </div>        
    </div>
</footer>
</body>	
</html>
